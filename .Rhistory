summary(MSoutput$MMGFAsolutions,2)
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,2)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings","intercepts"),nsclust=c(1,5),nfactors=2,maxiter = 5000,nruns = 10,design=design)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("intercepts"),nsclust=c(1,5),nfactors=2,maxiter = 5000,nruns = 10,design=design)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("intercepts","residuals"),nsclust=c(1,5),nfactors=2,maxiter = 5000,nruns = 10,design=design)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("residuals"),nsclust=c(1,5),nfactors=2,maxiter = 5000,nruns = 10,design=design)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings","intercepts","residuals"),nsclust=c(1,5),nfactors=2,maxiter = 5000,nruns = 10,design=design)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings","intercepts","residuals"),nsclust=c(1,5),nfactors=2,maxiter = 5000,nruns = 10,design=0)
source("~/mixmgfa/R/MixtureMG_FA_loadingsinterceptsresiduals.R")
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings","intercepts","residuals"),nsclust=c(1,5),nfactors=2,maxiter = 5000,nruns = 10,design=design)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings","intercepts","residuals"),nsclust=c(1,5),nfactors=2,maxiter = 5000,nruns = 10,design=design)
summary(MSoutput$MMGFAsolutions,2)
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,2)
source("~/mixmgfa/R/summarymixmgfa.R")
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,2)
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,2)
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,2)
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,2)
source("~/mixmgfa/R/summarymixmgfa.R")
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,2)
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,2)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings","intercepts"),nsclust=c(1,5),nfactors=1,maxiter = 5000,nruns = 10,design=design)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings","intercepts"),nsclust=c(1,5),nfactors=1,maxiter = 5000,nruns = 10,design=design)
debugSource("~/mixmgfa/R/MixtureMG_FA_loadingsandintercepts.R")
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings","intercepts"),nsclust=c(1,5),nfactors=1,maxiter = 5000,nruns = 10,design=design)
debugSource("~/mixmgfa/R/MixtureMG_FA_loadingsandintercepts.R")
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings","intercepts"),nsclust=c(1,5),nfactors=1,maxiter = 5000,nruns = 10,design=design)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings","intercepts"),nsclust=c(1,5),nfactors=1,maxiter = 5000,nruns = 10,design=0)
lambda_k%*%phi_gk
debugSource("~/mixmgfa/R/MixtureMG_FA_loadingsandintercepts.R")
source("~/mixmgfa/R/MixtureMG_FA_loadingsandintercepts.R")
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings","intercepts"),nsclust=c(1,5),nfactors=1,maxiter = 5000,nruns = 10,design=0)
source("~/mixmgfa/R/mixmgfa.R")
source("~/mixmgfa/R/mixmgfa.R")
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings","intercepts"),nsclust=c(1,5),nfactors=1,maxiter = 5000,nruns = 10,design=design)
source("~/mixmgfa/R/mixmgfa.R")
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings","intercepts"),nsclust=c(1,5),nfactors=1,maxiter = 5000,nruns = 10,design=0)
design=0
ncol(design)
is.null(design)
design==0
source("~/mixmgfa/R/mixmgfa.R")
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings","intercepts"),nsclust=c(1,5),nfactors=1,maxiter = 5000,nruns = 10,design=0)
summary(MSoutput$MMGFAsolutions,2)
source("~/mixmgfa/R/MixtureMG_FA_loadingsinterceptsresiduals.R")
source("~/mixmgfa/R/MixtureMG_FA_loadingsinterceptsresiduals.R")
debugSource("~/mixmgfa/R/MixtureMG_FA_loadingsinterceptsresiduals.R")
library(mixmgfa)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings","intercepts","residuals"),nsclust=c(1,5),nfactors=1,maxiter = 5000,nruns = 10,design=design)
View(Lambda_ks)
View(Lambda_ks)
View(Lambda_ks[[1]])
View(Lambda_ks2[[1]])
View(design)
View(design)
IM=diag(nfactors)
design=c(2,2,1,1,2,1,1,1,2,1,1,2)
design=IM[design,]
design[9,1]=1
nfactors=2
IM=diag(nfactors)
design=c(2,2,1,1,2,1,1,1,2,1,1,2)
design=IM[design,]
design[9,1]=1
View(design)
View(design)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings","intercepts","residuals"),nsclust=c(1,5),nfactors=1,maxiter = 5000,nruns = 10,design=design)
View(Lambda_ks2[[1]])
design
design
IM=diag(nfactors)
design=c(2,2,1,1,2,1,1,1,2,1,1,2)
design=IM[design,]
design[9,1]=1
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings","intercepts","residuals"),nsclust=c(1,5),nfactors=2,maxiter = 5000,nruns = 10,design=design)
View(Lambda_ks2[[1]])
View(Lambda_ks[[1]])
Lambda_ks2=matrix(list(NA),nrow = 1, ncol=nclust)
for(k in 1:nclust){
if(N_ks[k]>0){
lambda_k=matrix(0,nrow=nvar,ncol=nfactors)
Psi_k=Psi_ks[[k]]
for(j in 1:nvar){
nfactors_j=sum(design[j,])
d_j=design[j,]==1
sumSbeta=matrix(0,1,nfactors_j)
sumthetaalpha=matrix(0,nfactors_j,nfactors_j)
summeansalpha=matrix(0,1,nfactors_j)
for(g in 1:ngroup){
if(N_gks[g,k]>0){
S_gk=S_gks[[g,k]]
beta_gk=Beta_gks[[g,k]]
beta_gk=beta_gk[d_j, ,drop=FALSE]
theta_gk=Theta_gks[[g,k]]
theta_gk=theta_gk[d_j,d_j]
alpha_gk=alpha_gks[[g,k]]
alpha_gk=alpha_gk[d_j]
meanexpeta_gk=meanexpEta_gks[[g,k]]
meanexpeta_gk=meanexpeta_gk[d_j]
talpha_gk=t(alpha_gk)
sumSbeta=sumSbeta+(N_gks[g,k])*S_gk[j,]%*%t(beta_gk)
sumthetaalpha=sumthetaalpha+(N_gks[g,k])*(theta_gk+(alpha_gk+meanexpeta_gk)%*%talpha_gk)
summeansalpha=summeansalpha+(N_gks[g,k])*((mean_gs[g,j]-tau_ks[k,j])%*%alpha_gk)
}
}
lambda_k[j,design[j,]==1]= t(solve(sumthetaalpha,t(sumSbeta+summeansalpha)))
}
Lambda_ks2[[k]]=lambda_k
}
}
View(Lambda_ks2[[1]])
Lambda_ks2[[1]]
source("~/mixmgfa/R/MixtureMG_FA_loadingsinterceptsresiduals.R")
debugSource("~/mixmgfa/R/MixtureMG_FA_loadingsinterceptsresiduals.R")
library(mixmgfa)
source("~/mixmgfa/R/mixmgfa.R")
design
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings","intercepts","residuals"),nsclust=c(1,5),nfactors=2,maxiter = 5000,nruns = 10,design=design)
view(Lambda_ks[[1]])
View(Lambda_ks)
View(Lambda_ks)
View(Lambda_ks[[1]])
View(Lambda_ks2[[1]])
View(Lambda_ks3[[1]])
source("~/mixmgfa/R/MixtureMG_FA_loadingsinterceptsresiduals.R")
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings","intercepts","residuals"),nsclust=c(1,5),nfactors=2,maxiter = 5000,nruns = 10,design=design)
design
max(design)
sum(design)
source("~/mixmgfa/R/MixtureMG_FA_loadingsinterceptsresiduals.R")
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings","intercepts","residuals"),nsclust=c(1,5),nfactors=2,maxiter = 5000,nruns = 10,design=design)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings","intercepts","residuals"),nsclust=c(1,5),nfactors=1,maxiter = 5000,nruns = 10,design=design)
source("~/mixmgfa/R/MixtureMG_FA_loadingsinterceptsresiduals.R")
source("~/mixmgfa/R/MixtureMG_FA_interceptsandresiduals.R")
source("~/mixmgfa/R/MixtureMG_FA_residuals.R")
source("~/mixmgfa/R/MixtureMG_FA_loadingsinterceptsresiduals.R")
source("~/mixmgfa/R/MixtureMG_FA_interceptsandresiduals.R")
source("~/mixmgfa/R/MixtureMG_FA_residuals.R")
source("~/mixmgfa/R/mixmgfa.R")
source("~/mixmgfa/R/mixmgfa.R")
source("~/mixmgfa/R/mixmgfa.R")
source("~/mixmgfa/R/summarymixmgfa.R")
source("~/mixmgfa/R/summarymixmgfa.R")
View(MSoutput)
View(MSoutput)
summary(MSoutput$MMGFAsolutions,nclust=2)
source("~/mixmgfa/R/summarymixmgfa.R")
source("~/mixmgfa/R/summarymixmgfa.R")
source("~/mixmgfa/R/summarymixmgfa.R")
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings","intercepts","residuals"),nsclust=c(1,5),nfactors=2,maxiter = 5000,nruns = 10,design=design)
debugSource("~/mixmgfa/R/mixmgfa.R")
library(mixmgfa)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings","intercepts","residuals"),nsclust=c(1,5),nfactors=2,maxiter = 5000,nruns = 10,design=design)
output_nclust$pi_ks
noquote(paste(prefix,suffix,sep="_"))
colnames(output_nclust$pi_ks)<-noquote(paste(prefix,suffix,sep="_"))
names(output_nclust$pi_ks)<-noquote(paste(prefix,suffix,sep="_"))
output_nclust$pi_ks
source("~/mixmgfa/R/mixmgfa.R")
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings","intercepts","residuals"),nsclust=c(1,5),nfactors=2,maxiter = 5000,nruns = 10,design=design)
source("~/mixmgfa/R/mixmgfa.R")
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings","intercepts","residuals"),nsclust=c(1,5),nfactors=2,maxiter = 5000,nruns = 10,design=design)
source("~/mixmgfa/R/summarymixmgfa.R")
source("~/mixmgfa/R/summarymixmgfa.R")
source("~/mixmgfa/R/summarymixmgfa.R")
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,nclust=2)
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,nclust=2)
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,nclust=2)
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,nclust=2)
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,nclust=2)
which(round(MSoutput$MMGFAsolutions$`2.clusters`$clustermemberships[,2])==1)
cluster1<-names(which(round(MSoutput$MMGFAsolutions$`2.clusters`$clustermemberships[,2])==1))
cluster1
cluster2<-names(which(round(MSoutput$MMGFAsolutions$`2.clusters`$clustermemberships[,1])==1))
cluster1
cluster2
source("~/mixmgfa/R/summarymixmgfa.R")
which(round(MSoutput$MMGFAsolutions$`2.clusters`$clustermemberships[,2])==1)
summary(MSoutput$MMGFAsolutions,nclust=2)
source("~/mixmgfa/R/summarymixmgfa.R")
source("~/mixmgfa/R/summarymixmgfa.R")
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,nclust=2)
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,nclust=2)
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,nclust=2)
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,nclust=2)
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,nclust=2)
source("~/mixmgfa/R/summarymixmgfa.R")
sum(MSoutput$MMGFAsolutions$`2.clusters`$clusterspecific.uniquevariances[[1]]!=0)
source("~/mixmgfa/R/summarymixmgfa.R")
source("~/mixmgfa/R/summarymixmgfa.R")
lapply(MSoutput$MMGFAsolutions$`2.clusters`$clusterspecific.uniquevariances,diag)
as.data.frame(lapply(MSoutput$MMGFAsolutions$`2.clusters`$clusterspecific.uniquevariances,diag))
t(as.data.frame(lapply(MSoutput$MMGFAsolutions$`2.clusters`$clusterspecific.uniquevariances,diag)))
ind=which(round(MSoutput$MMGFAsolutions$`2.clusters`$clustermemberships))==1)
ind=which(round(MSoutput$MMGFAsolutions$`2.clusters`$clustermemberships)==1)
ind
MSoutput$MMGFAsolutions$`2.clusters`$group.and.clusterspecific.factormeans[[ind]]
View(MSoutput)
View(MSoutput)
source("~/mixmgfa/R/mixmgfa.R")
MSoutput$MMGFAsolutions$`2.clusters`$group.and.clusterspecific.factormeans[[94]]
MSoutput$MMGFAsolutions$`2.clusters`$group.and.clusterspecific.factormeans[[93]]
MSoutput$MMGFAsolutions$`2.clusters`$group.and.clusterspecific.factormeans[[2]]
MSoutput$MMGFAsolutions$`2.clusters`$group.and.clusterspecific.factormeans[[ind]]
MSoutput$MMGFAsolutions$`2.clusters`$group.and.clusterspecific.factormeans[[2:5]]
MSoutput$MMGFAsolutions$`2.clusters`$group.and.clusterspecific.factormeans[[c(2,4)]]
source("~/mixmgfa/R/summarymixmgfa.R")
source("~/mixmgfa/R/summarymixmgfa.R")
MSoutput$MMGFAsolutions$`2.clusters`$group.and.clusterspecific.factormeans[[2 5]]
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,nclust=2)
source("~/mixmgfa/R/summarymixmgfa.R")
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,nclust=2)
source("~/mixmgfa/R/summarymixmgfa.R")
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,nclust=2)
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,nclust=2)
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,nclust=2)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("intercepts"),nsclust=c(1,5),nfactors=2,maxiter = 5000,nruns = 10,design=design)
summary(MSoutput$MMGFAsolutions,nclust=3)
summary(MSoutput$MMGFAsolutions,nclust=2)
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,nclust=2)
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,nclust=2)
source("~/mixmgfa/R/summarymixmgfa.R")
lappy(MSoutput$MMGFAsolutions$`3.clusters`$groupspecific.uniquevariances,diag)
lapply(MSoutput$MMGFAsolutions$`3.clusters`$groupspecific.uniquevariances,diag)
as.data.frame(lapply(MSoutput$MMGFAsolutions$`3.clusters`$groupspecific.uniquevariances,diag))
as.matrix(lapply(MSoutput$MMGFAsolutions$`3.clusters`$groupspecific.uniquevariances,diag))
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,nclust=2)
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,nclust=2)
unlist(lapply(MSoutput$MMGFAsolutions$`3.clusters`$groupspecific.uniquevariances,diag))
unlist(lapply(MSoutput$MMGFAsolutions$`3.clusters`$groupspecific.uniquevariances,diag),use.names=FALSE)
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,nclust=2)
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,nclust=2)
source("~/mixmgfa/R/summarymixmgfa.R")
source("~/mixmgfa/R/summarymixmgfa.R")
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,nclust=2)
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,nclust=2)
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,nclust=2)
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,nclust=2)
source("~/mixmgfa/R/summarymixmgfa.R")
summary(MSoutput$MMGFAsolutions,nclust=2)
source("~/mixmgfa/R/summarymixmgfa.R")
MSoutput$overview
source("~/mixmgfa/R/plotModelselection.R")
plot(MSoutput$overview)
source("~/mixmgfa/R/plotModelselection.R")
plot(MSoutput$overview)
source("~/mixmgfa/R/plotModelselection.R")
plot(MSoutput$overview)
source("~/mixmgfa/R/plotModelselection.R")
plot(MSoutput$overview)
source("~/mixmgfa/R/plotModelselection.R")
plot(MSoutput$overview)
source("~/mixmgfa/R/plotModelselection.R")
plot(MSoutput$overview)
source("~/mixmgfa/R/plotModelselection.R")
plot(MSoutput$overview)
source("~/mixmgfa/R/plotModelselection.R")
plot(MSoutput$overview)
source("~/mixmgfa/R/plotModelselection.R")
plot(MSoutput$overview)
debugSource("~/mixmgfa/R/mixmgfa.R")
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,6),nfactors=2,maxiter = 5000,nruns = 5,design=design)
helling=(LL_nclustplus1-LL_nclustmin1)/(npar_nclustplus1-npar_nclustmin1)
helling=(LL_nclustplus1-LL_nclustmin1)/(npar_nclustplus1-npar_nclustmin1)
helling
puntoplijn=LL_nclustmin1+helling*(LL_nclust-LLnclustmin1)
puntoplijn=LL_nclustmin1+helling*(LL_nclust-LL_nclustmin1)
puntoplijn
LL_nclust
debugSource("~/mixmgfa/R/mixmgfa.R")
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,6),nfactors=2,maxiter = 5000,nruns = 5,design=design)
screeratios
debugSource("~/mixmgfa/R/mixmgfa.R")
library(mixmgfa)
source("~/mixmgfa/R/plotModelselection.R")
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,6),nfactors=2,maxiter = 5000,nruns = 5,design=design)
point_line
LL_nclust
LL_nclust<point_line
source("~/mixmgfa/R/mixmgfa.R")
source("~/mixmgfa/R/mixmgfa.R")
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,6),nfactors=2,maxiter = 5000,nruns = 5,design=design)
plot(MSoutput$overview)
source("~/mixmgfa/R/plotModelselection.R")
plot(MSoutput$overview)
source("~/mixmgfa/R/plotModelselection.R")
plot(MSoutput$overview)
source("~/mixmgfa/R/plotModelselection.R")
plot(MSoutput$overview)
source("~/mixmgfa/R/plotModelselection.R")
plot(MSoutput$overview)
which(!is.na(MSoutput$overview[,6])
)
source("~/mixmgfa/R/plotModelselection.R")
plot(MSoutput$overview)
source("~/mixmgfa/R/plotModelselection.R")
plot(MSoutput$overview)
source("~/mixmgfa/R/plotModelselection.R")
source("~/mixmgfa/R/plotModelselection.R")
plot(MSoutput$overview)
source("~/mixmgfa/R/mixmgfa.R")
debugSource("~/mixmgfa/R/mixmgfa.R")
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,6),nfactors=2,maxiter = 5000,nruns = 5,design=design)
library(mixmgfa)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,6),nfactors=2,maxiter = 5000,nruns = 5,design=design)
screeratios
debugSource("~/mixmgfa/R/mixmgfa.R")
debugSource("~/mixmgfa/R/mixmgfa.R")
set.seed(1)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,6),nfactors=2,maxiter = 5000,nruns = 5,design=design)
nsclusthull
nclust
debugSource("~/mixmgfa/R/mixmgfa.R")
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,6),nfactors=2,maxiter = 5000,nruns = 5,design=design)
nclust-nsclust[1]+1
nclust-nsclust[1]
source("~/mixmgfa/R/mixmgfa.R")
source("~/mixmgfa/R/mixmgfa.R")
source("~/mixmgfa/R/mixmgfa.R")
debugSource("~/mixmgfa/R/mixmgfa.R")
library(mixmgfa)
set.seed(1)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,6),nfactors=2,maxiter = 5000,nruns = 5,design=design)
debugSource("~/mixmgfa/R/mixmgfa.R")
debugSource("~/mixmgfa/R/mixmgfa.R")
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,6),nfactors=2,maxiter = 5000,nruns = 5,design=design)
set.seed(1)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,6),nfactors=2,maxiter = 5000,nruns = 5,design=design)
screeratios
convexhull
nrhull
debugSource("~/mixmgfa/R/mixmgfa.R")
set.seed(1)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,6),nfactors=2,maxiter = 5000,nruns = 5,design=design)
nclust
convexhull[nclust]
nrhull
2:nrhull-1
debugSource("~/mixmgfa/R/mixmgfa.R")
debugSource("~/mixmgfa/R/mixmgfa.R")
debugSource("~/mixmgfa/R/mixmgfa.R")
set.seed(1)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,6),nfactors=2,maxiter = 5000,nruns = 5,design=design)
debugSource("~/mixmgfa/R/mixmgfa.R")
set.seed(1)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,6),nfactors=2,maxiter = 5000,nruns = 5,design=design)
debugSource("~/mixmgfa/R/mixmgfa.R")
set.seed(1)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,6),nfactors=2,maxiter = 5000,nruns = 5,design=design)
debugSource("~/mixmgfa/R/mixmgfa.R")
set.seed(1)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,6),nfactors=2,maxiter = 5000,nruns = 5,design=design)
debugSource("~/mixmgfa/R/mixmgfa.R")
set.seed(1)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,6),nfactors=2,maxiter = 5000,nruns = 5,design=design)
debugSource("~/mixmgfa/R/mixmgfa.R")
set.seed(1)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,6),nfactors=2,maxiter = 5000,nruns = 5,design=design)
convexhull
nclust
convexhull[nclust]-nsclust[1]+1
convexhull[nclust-1]-nsclust[1]+1
convexhull[nclust+1]-nsclust[1]+1
screeratios[convexhull[nclust]-nsclust[1]+1]
((LL_nclust-LL_nclustmin1)/(npar_nclust-npar_nclustmin1))/((LL_nclustplus1-LL_nclust)/(npar_nclustplus1-npar_nclust))
convexhull[nclust]-nsclust[1]+1
convexhull[nclust-1]-nsclust[1]+1
convexhull[nclust+1]-nsclust[1]+1
LL_nclust>=point_line
screeratios[convexhull[nclust]-nsclust[1]+1]
((LL_nclust-LL_nclustmin1)/(npar_nclust-npar_nclustmin1))/((LL_nclustplus1-LL_nclust)/(npar_nclustplus1-npar_nclust))
debugSource("~/mixmgfa/R/mixmgfa.R")
library(mixmgfa)
set.seed(1)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,6),nfactors=2,maxiter = 5000,nruns = 5,design=design)
debugSource("~/mixmgfa/R/mixmgfa.R")
set.seed(1)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,6),nfactors=2,maxiter = 5000,nruns = 5,design=design)
source("~/mixmgfa/R/mixmgfa.R")
set.seed(1)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,6),nfactors=2,maxiter = 5000,nruns = 1,design=design)
plot(MSoutput$overview)
debugSource("~/mixmgfa/R/mixmgfa.R")
set.seed(1)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,6),nfactors=2,maxiter = 5000,nruns = 3,design=design)
convexhull[nclust-1:nclust+1]
convexhull[(nclust-1):(nclust+1)]
screeratios
all.equal(convexhull[(nclust-1):(nclust+1)],c(convexhull[nclust]-1,convexhull[nclust],convexhull[nclust]+1))
!all.equal(convexhull[(nclust-1):(nclust+1)],c(convexhull[nclust]-1,convexhull[nclust],convexhull[nclust]+1))
source("~/mixmgfa/R/mixmgfa.R")
debugSource("~/mixmgfa/R/mixmgfa.R")
library(mixmgfa)
debugSource("~/mixmgfa/R/mixmgfa.R")
set.seed(1)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,6),nfactors=2,maxiter = 5000,nruns = 3,design=design)
debugSource("~/mixmgfa/R/mixmgfa.R")
set.seed(1)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,6),nfactors=2,maxiter = 5000,nruns = 3,design=design)
convexhull[(nclust-1):(nclust+1)]
c(convexhull[nclust]-1,convexhull[nclust],convexhull[nclust]+1)
c(convexhull[nclust]-1,convexhull[nclust],convexhull[nclust]+1)
!all.equal(convexhull[(nclust-1):(nclust+1)],c(convexhull[nclust]-1,convexhull[nclust],convexhull[nclust]+1))
debugSource("~/mixmgfa/R/mixmgfa.R")
set.seed(1)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,6),nfactors=2,maxiter = 5000,nruns = 3,design=design)
2:(nrhull-1)
nclust=3
!all.equal(convexhull[(nclust-1):(nclust+1)],c(convexhull[nclust]-1,convexhull[nclust],convexhull[nclust]+1))
convexhull[(nclust-1):(nclust+1)]
c(convexhull[nclust]-1,convexhull[nclust],convexhull[nclust]+1)
!all.equal(convexhull[(nclust-1):(nclust+1)],c(convexhull[nclust]-1,convexhull[nclust],convexhull[nclust]+1))
all.equal(convexhull[(nclust-1):(nclust+1)],c(convexhull[nclust]-1,convexhull[nclust],convexhull[nclust]+1))
all.equal(convexhull[(nclust-1):(nclust+1)],c(convexhull[nclust]-1,convexhull[nclust],convexhull[nclust]+1))==FALSE
all.equal(convexhull[(nclust-1):(nclust+1)],c(convexhull[nclust]-1,convexhull[nclust],convexhull[nclust]+1))!=TRUE
identical(convexhull[(nclust-1):(nclust+1)],c(convexhull[nclust]-1,convexhull[nclust],convexhull[nclust]+1))
8identical(convexhull[(nclust-1):(nclust+1)],c(convexhull[nclust]-1,convexhull[nclust],convexhull[nclust]+1))
!identical(convexhull[(nclust-1):(nclust+1)],c(convexhull[nclust]-1,convexhull[nclust],convexhull[nclust]+1))
debugSource("~/mixmgfa/R/mixmgfa.R")
source("~/mixmgfa/R/mixmgfa.R")
source("~/mixmgfa/R/mixmgfa.R")
source("~/mixmgfa/R/mixmgfa.R")
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,7),nfactors=2,maxiter = 5000,nruns = 3,design=design)
plot(MSoutput$overview)
((-206899.9+206983.8)/(1328-1304))/((-206874.8+206899.9)/(1340-1328))
((-206899.9+206944.4)/(1328-1316))/((-206874.8+206899.9)/(1340-1328))
source("~/mixmgfa/R/mixmgfa.R")
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,6),nfactors=2,maxiter = 5000,nruns = 3,design=0)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,6),nfactors=2,maxiter = 5000,nruns = 50,design=0)
source("~/mixmgfa/R/mixmgfa.R")
source("~/mixmgfa/R/mixmgfa.R")
plot(MSoutput$overview)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,8),nfactors=2,maxiter = 5000,nruns = 100,design=0)
source("~/mixmgfa/R/mixmgfa.R")
source("~/mixmgfa/R/mixmgfa.R")
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,8),nfactors=2,maxiter = 5000,nruns = 100,design=0,preselect=50)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,8),nfactors=2,maxiter = 5000,nruns = 200,design=0,preselect=50)
MSoutput<-mixmgfa(normdata,N_gs,cluster.spec=c("loadings"),nsclust=c(1,7),nfactors=2,maxiter = 5000,nruns = 200,design=0,preselect=50)
plot(MSoutput$overview)
source("~/mixmgfa/R/mixmgfa.R")
source("~/mixmgfa/R/mixmgfa.R")
overview=MSoutput$overview
nclust=6
LL_nclust=overview[nclust-nsclust[1]+1,2]
npar_nclust=overview[nclust-nsclust[1]+1,3]
LL_nclustmin1=overview[nclust-nsclust[1],2]
npar_nclustmin1=overview[nclust-nsclust[1],3]
LL_nclustplus1=overview[nclust-nsclust[1]+2,2]
npar_nclustplus1=overview[nclust-nsclust[1]+2,3]
# determine whether intermediate point is part of the convex hull
slope=(LL_nclustplus1-LL_nclustmin1)/(npar_nclustplus1-npar_nclustmin1)
point_line=LL_nclustmin1+slope*(npar_nclust-npar_nclustmin1)
LL_nclust=overview[nclust,2]
npar_nclust=overview[nclust,3]
LL_nclustmin1=overview[nclust-1,2]
npar_nclustmin1=overview[nclust-1,3]
LL_nclustplus1=overview[nclust+1,2]
npar_nclustplus1=overview[nclust+1,3]
# determine whether intermediate point is part of the convex hull
slope=(LL_nclustplus1-LL_nclustmin1)/(npar_nclustplus1-npar_nclustmin1)
point_line=LL_nclustmin1+slope*(npar_nclust-npar_nclustmin1)
point_line
overview
overview[6,2]>point_line
LL_nclust=overview[nclust,2]
npar_nclust=overview[nclust,3]
LL_nclustmin1=overview[4,2]
npar_nclustmin1=overview[4,3]
LL_nclustplus1=overview[nclust+1,2]
npar_nclustplus1=overview[nclust+1,3]
# determine whether intermediate point is part of the convex hull
slope=(LL_nclustplus1-LL_nclustmin1)/(npar_nclustplus1-npar_nclustmin1)
point_line=LL_nclustmin1+slope*(npar_nclust-npar_nclustmin1)
point_line
overview[6,2]>point_line
overview[6,2]-point_line
overview[6,2]
nclust
source("~/mixmgfa/R/mixmgfa.R")
